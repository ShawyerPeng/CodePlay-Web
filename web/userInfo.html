<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <title>用户中心</title>
    <link href="bootstrap-3.3.5-dist/css/bootstrap.min.css" title="" rel="stylesheet"/>
    <link title="" href="css/style.css" rel="stylesheet" type="text/css"/>
    <link title="blue" href="css/dermadefault.css" rel="stylesheet" type="text/css"/>
    <link title="green" href="css/dermagreen.css" rel="stylesheet" type="text/css" disabled="disabled"/>
    <link title="orange" href="css/dermaorange.css" rel="stylesheet" type="text/css" disabled="disabled"/>
    <link href="css/templatecss.css" rel="stylesheet" title="" type="text/css"/>
    <link href="css/buttons.css">
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="script/jquery.cookie.js" type="text/javascript"></script>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.2.0/jquery-confirm.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.2.0/jquery-confirm.min.js"></script>
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.min.css" />-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/locales/bootstrap-datepicker.zh-TW.min.js"></script>-->
</head>

<body>
<nav class="nav navbar-default navbar-mystyle navbar-fixed-top">
    <div class="navbar-header">
        <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand mystyle-brand"><span class="glyphicon glyphicon-home"></span></a></div>
    <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
            <li class="li-border"><a class="mystyle-color" href="#">管理控制台</a></li>
        </ul>

        <ul class="nav navbar-nav pull-right">
            <li class="li-border">
                <a href="#" class="mystyle-color">
                    <span class="glyphicon glyphicon-bell"></span>
                    <span class="topbar-num">0</span>
                </a>
            </li>
            <li class="li-border dropdown"><a href="#" class="mystyle-color" data-toggle="dropdown">
                <span class="glyphicon glyphicon-search"></span> 搜索</a>
                <div class="dropdown-menu search-dropdown">
                    <div class="input-group">
                        <input type="text" class="form-control">
                        <span class="input-group-btn">
                   <button type="button" class="btn btn-default">搜索</button>
                </span>
                    </div>
                </div>
            </li>
            <li class="dropdown li-border"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">帮助与文档<span
                    class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a href="#">帮助与文档</a></li>
                    <li class="divider"></li>
                    <li><a href="#">论坛</a></li>
                    <li class="divider"></li>
                    <li><a href="#">博客</a></li>
                </ul>
            </li>
            <li class="dropdown li-border"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">退出<span
                    class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a href="login.html">退出</a></li>
                </ul>
            </li>
            <li class="dropdown"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">换肤<span
                    class="caret"></span></a>
                <ul class="dropdown-menu changecolor">
                    <li id="blue"><a href="#">蓝色</a></li>
                    <li class="divider"></li>
                    <li id="green"><a href="#">绿色</a></li>
                    <li class="divider"></li>
                    <li id="orange"><a href="#">橙色</a></li>
                </ul>
            </li>
        </ul>
    </div>
</nav>
<div class="down-main">
    <div class="left-main left-full">
        <div class="sidebar-fold"><span class="glyphicon glyphicon-menu-hamburger"></span></div>
        <div class="subNavBox">
            <div class="sBox">
                <div class="subNav sublist-down"><span class="title-icon glyphicon glyphicon-chevron-down"></span><span
                        class="sublist-title">用户中心</span>
                </div>
                <ul class="navContent" style="display:block">
                    <li class="active">
                        <div class="showtitle" style="width:100px;"><img src="img/leftimg.png"/>账号管理</div>
                        <a href="userInfo.html"><span class="sublist-icon glyphicon glyphicon-user"></span><span
                                class="sub-title">账号管理</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="img/leftimg.png"/>消息中心</div>
                        <a href="message.html"><span class="sublist-icon glyphicon glyphicon-envelope"></span><span
                                class="sub-title">消息中心</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="img/leftimg.png"/>上传图片</div>
                        <a href="smsInfo.html"><span class="sublist-icon glyphicon glyphicon-bullhorn"></span><span
                                class="sub-title">上传图片</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="img/leftimg.png"/>实名认证</div>
                        <a href="identify.html"><span class="sublist-icon glyphicon glyphicon-credit-card"></span><span
                                class="sub-title">实名认证</span></a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="right-product view-product right-full">
        <div class="container-fluid">
            <div class="manage account-manage info-center">
                <div class="page-header">
                    <div class="pull-left">
                        <h4>用户中心</h4>
                    </div>
                </div>
                <dl class="account-basic clearfix">
                    <dt class="pull-left">
                    <p class="account-head">
                        <img src="" id="avatar">
                    </p>
                    </dt>
                    <dd class="pull-left margin-large-left margin-small-top">
                        <p class="text-small">
                            <button id="edit" class="button button-primary button-rounded button-small" style="background-color: #4cb0f9; color: #FFF;">修改资料</button>
                        <form id="uploadForm" method="post" enctype="multipart/form-data">
                        <input type="file" id="btn_file" name="img" onchange="upload()" size="50" style="display: none; position:absolute">
                            <button type="button" id="edit_avatar" onclick="$('#btn_file').click()" class="button button-primary button-rounded button-small" style="background-color: #4824a2; color: #FFF;">上传头像</button>
                        </form>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">会员账号</span>:<span class="margin-left" id="realname"></span><br/>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">认证状态</span>:
                            <span class="margin-left">已认证</span>
                            <!-- <a class="margin-left text-main text-underline" href="#">立即认证</a> -->
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">注册时间</span>:<span class="margin-left">2015-01-12 11:50:22</span>
                        </p>
                    </dd>
                </dl>

                <dl class="account-basic clearfix">
                    <dd class="pull-left margin-large-left margin-small-top">
                        <p class="text-small">
                            <span class="show pull-left base-name">姓名</span>:<span class="margin-left" id="name"></span>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">邮箱</span>:<span class="margin-left" id="email"></span>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">手机号</span>:<span class="margin-left" id="phone"></span>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">身份证号</span>:<span class="margin-left" id="idcard"></span>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">性别</span>:<span class="margin-left" id="sex"></span>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">生日</span>:<span class="margin-left" id="birthday"></span>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">职业</span>:<span class="margin-left" id="job"></span>
                        </p>
                        <p class="text-small">
                            <span class="show pull-left base-name">诚信值</span>:<span class="margin-left" id="honesty"></span>
                        </p>
                    </dd>
                </dl>
                <div class="account-basic clearfix">
                    <span class="pull-left show text-small">您当前的账号安全程度</span>
                    <div class="progress-bar pull-left margin-large-left margin-large-35">
                        <div style="background: rgb(255, 153, 0) none repeat scroll 0% 0%; width: 180px;"
                             data-width="100">
                        </div>
                    </div>
                    <span class="pull-left show text-small">安全级别: <span style="color: rgb(255, 153, 0);" class="leval-safe">高</span></span>
                </div>
                <ul class="accound-bund">
                    <li class="clearfix">
                        <span class="bund-class">登录密码</span>
                        <span class="w45">安全性高的密码可以使账号更安全，建议您定期更换密码，设置一个包含字母，符号或数字中至少两项且长度超过6位的密码。</span>
                        <span class="pull-right margin-large-right">
						<i class="glyphicon glyphicon-ok-circle pull-left"></i>
						<em class="margin-right text-green-deep">已设置</em>
						            		|
						<a href="#" data-panel="modify_pass" data-title="修改密码-修改密码"
                           data-callback="$(&quot;#modify_pass&quot;).submit();" data-btn="下一步,取消"
                           class="button-word1 margin-left btn_ajax_open">修改</a>
						<input data-panel="modify_pass2" data-title="修改密码-修改完成" data-btn="完成"
                               data-callback="layer.closeAll();" class="modify_pass_setup2 btn_ajax_open" value="第三步"
                               type="hidden">
						</span>
                    </li>

                    <li class="clearfix">
                        <span class="bund-class">邮箱绑定</span>
                        <span class="w45">绑定邮箱可以用于安全验证、找回密码等重要操作</span>
                        <span class="pull-right margin-large-right">
						<i class="glyphicon glyphicon-ok-circle pull-left"></i>
						<em class="margin-right text-green-deep">已设置</em>
						            					            		|
						<a href="#" data-panel="modify-email-revise" data-title="修改绑定邮箱-邮箱验证" data-btn="发送验证到邮箱,取消"
                           data-callback="$(&quot;#modify_email&quot;).submit();"
                           class="button-word1 margin-left btn_ajax_open">修改</a>
						<input data-panel="modify-email-revise2" data-title="修改绑定邮箱-修改成功" data-btn="完成"
                               data-callback="layer.closeAll();" class="modif_email_setup2 btn_ajax_open" type="hidden">
						</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $.ajax({
            url: 'http://114.115.212.203:8001/do_login/',
            type: 'POST',
            data: {
                "name": "admin",
                "pwd": "9876543210"
            },
            dataType: "json",
            success: function (returndata) {
                console.log(returndata.msg);
            },
            error: function (returndata) {
                console.log(returndata.msg);
            }
        });
        $.ajax({
            url: 'http://114.115.212.203:8001/info/',
            type: 'GET',
            xhrFields: {
                withCredentials: true
            },
            dataType: "json",
            success: function (returndata) {
                $('#image').html(returndata.user.faceurl);
                $('#name').html(returndata.user.uname);
                $('#realname').html(returndata.user.urealname);
                $('#email').html(returndata.user.uemail);
                $('#tel').html(returndata.user.utel);
                $('#idcard').html(returndata.user.uidcard);
                if(returndata.user.usex===0) {
                    $('#sex').html("女");
                } else if(returndata.user.usex===1) {
                    $('#sex').html("男");
                } else if(returndata.user.usex===-1) {
                    $('#sex').html("未填写");
                }

                $('#birthday').html(returndata.user.uyear + "-" + returndata.user.umonth + "-" + returndata.user.uday);
                $('#job').html(returndata.user.uidentity);
                $('#honesty').html(returndata.user.uhonesty);
                $("#avatar").attr("src", "http://114.115.212.203:8001" + returndata.user.faceurl);
            },
            error: function (returndata) {
                console.log(returndata.msg);
            }
        });
    });

    $("#edit").click(function () {
        $.confirm({
            title: '信息修改',
            content: '' +
            '<div class="form-group">' +
                '<input type="text" placeholder="姓名" id="ename" class="name form-control" required />' +
                '<input type="text" placeholder="性别" id="esex" class="name form-control" required />' +
                '<input type="text" placeholder="认证身份" id="eidentity" class="name form-control" required />' +
                '<input type="text" placeholder="身份证" id="eidcard" class="name form-control" required />' +
                '<input type="text" placeholder="手机号" id="etel" class="name form-control" required />' +
                '<input type="text" placeholder="年" id="eyear" class="name form-control" required /><nobr/>' +
                '<input type="text" placeholder="月" id="emonth" class="name form-control" required /><nobr/>' +
                '<input type="text" placeholder="日" id="eday" class="name form-control" required />' +
            '</div>',
            buttons: {
                formSubmit: {
                    text: 'Submit',
                    btnClass: 'btn-blue',
                    action: function () {
                        var name = this.$content.find('.name').val();
                        if(!name){
                            $.alert('provide a valid name');
                            return false;
                        }
                        var ename = $("#ename").val();
                        var esex = $("#esex").val();
                        var eidentity = $("#eidentity").val();
                        var eidcard = $("#eidcard").val();
                        var etel = $("#etel").val();
                        var eyear = parseInt($("#eyear").val());
                        var emonth = parseInt($("#emonth").val());
                        var eday = parseInt($("#eday").val());

                        if(esex==="男") esex="1";
                        if(esex==="女") esex="0";
                        if(esex!=="男"&&esex!=="女") esex="-1";

                        $.ajax({
                            url: 'http://114.115.212.203:8001/do_modify/',
                            type: 'POST',
                            xhrFields: {
                                withCredentials: true
                            },
                            data: {
                                'realname':ename,
                                'sex':esex,
                                'identity':eidentity,
                                'idcard':eidcard,
                                'tel':etel,
                                'year':eyear,
                                'month':emonth,
                                'day':eday
                            },
                            dataType: "json",
                            success: function (returndata) {
                                console.log(returndata);
                                location.reload();
                                $("#ename").reload();
                            },
                            error: function (returndata) {
                                console.log(returndata);
                            }
                        });
                    }
                },
                cancel: function () {
                    //close
                }
            },
            onContentReady: function () {
                var jc = this;
                this.$content.find('form').on('submit', function (e) {
                    // if the user submits the form by pressing enter in the field.
                    e.preventDefault();
                    jc.$$formSubmit.trigger('click'); // reference the button and click it
                });
            }
        });
    });

    function upload() {
        $.ajax({
            url: 'http://114.115.212.203:8001/do_uploadface/',
            type: 'POST',
            xhrFields: {
                withCredentials: true
            },
            data: new FormData($("#uploadForm")[0]),
            dataType: "json",
            processData: false,
            contentType: false,
            success: function (returndata) {
                console.log(returndata);
                location.reload();
            },
            error: function (returndata) {
                console.log(returndata);
            }
        });
    }
</script>
<script type="text/javascript">
    $(function () {
        /*换肤*/
        $(".dropdown .changecolor li").click(function () {
            var style = $(this).attr("id");
            $("link[title!='']").attr("disabled", "disabled");
            $("link[title='" + style + "']").removeAttr("disabled");

            $.cookie('mystyle', style, {expires: 7}); // 存储一个带7天期限的 cookie
        })
        var cookie_style = $.cookie("mystyle");
        if (cookie_style != null) {
            $("link[title!='']").attr("disabled", "disabled");
            $("link[title='" + cookie_style + "']").removeAttr("disabled");
        }
        /*左侧导航栏显示隐藏功能*/
        $(".subNav").click(function () {
            /*显示*/
            if ($(this).find("span:first-child").attr('class') == "title-icon glyphicon glyphicon-chevron-down") {
                $(this).find("span:first-child").removeClass("glyphicon-chevron-down");
                $(this).find("span:first-child").addClass("glyphicon-chevron-up");
                $(this).removeClass("sublist-down");
                $(this).addClass("sublist-up");
            }
            /*隐藏*/
            else {
                $(this).find("span:first-child").removeClass("glyphicon-chevron-up");
                $(this).find("span:first-child").addClass("glyphicon-chevron-down");
                $(this).removeClass("sublist-up");
                $(this).addClass("sublist-down");
            }
            // 修改数字控制速度， slideUp(500)控制卷起速度
            $(this).next(".navContent").slideToggle(300).siblings(".navContent").slideUp(300);
        })
        /*左侧导航栏缩进功能*/
        $(".left-main .sidebar-fold").click(function () {

            if ($(this).parent().attr('class') == "left-main left-full") {
                $(this).parent().removeClass("left-full");
                $(this).parent().addClass("left-off");

                $(this).parent().parent().find(".right-product").removeClass("right-full");
                $(this).parent().parent().find(".right-product").addClass("right-off");

            }
            else {
                $(this).parent().removeClass("left-off");
                $(this).parent().addClass("left-full");

                $(this).parent().parent().find(".right-product").removeClass("right-off");
                $(this).parent().parent().find(".right-product").addClass("right-full");

            }
        })

        /*左侧鼠标移入提示功能*/
        $(".sBox ul li").mouseenter(function () {
            if ($(this).find("span:last-child").css("display") == "none") {
                $(this).find("div").show();
            }
        }).mouseleave(function () {
            $(this).find("div").hide();
        })
    })
</script>
</body>
</html>
